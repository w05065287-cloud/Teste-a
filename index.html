<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>IA de Redações – Aluno & Professor</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#2563eb,#7c3aed);
  padding: 20px;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 12px;
}
h1 { text-align: center; color: #1d4ed8; }
textarea, select, button {
  width: 100%;
  margin-top: 10px;
  padding: 12px;
  font-size: 16px;
}
button {
  background: #1d4ed8;
  color: #fff;
  border: none;
  font-weight: bold;
  cursor: pointer;
}
button:hover { background: #1e40af; }
#resultado {
  margin-top: 20px;
  background: #f9fafb;
  padding: 20px;
  white-space: pre-wrap;
  border-radius: 8px;
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
<div class="container">

<h1>IA de Redações</h1>

<label>Modo</label>
<select id="modo">
  <option value="aluno">Aluno</option>
  <option value="professor">Professor</option>
</select>

<label>Tema</label>
<textarea id="tema" placeholder="Ex: O impacto da tecnologia na educação"></textarea>

<label>Nível</label>
<select id="nivel">
  <option value="fundamental">Fundamental</option>
  <option value="medio">Ensino Médio</option>
  <option value="enem">ENEM (sem proposta)</option>
</select>

<button onclick="gerarRedacao()">Gerar</button>
<button onclick="imprimir()">Imprimir</button>
<button onclick="gerarPDF()">Baixar PDF</button>

<div id="resultado"></div>

</div>

<script>
let textoFinal = "";

function escolher(lista){ return lista[Math.floor(Math.random()*lista.length)]; }

function evitarRepeticao(texto){
  const palavras = texto.split(" ");
  const usadas = new Set();
  return palavras.filter(p=>{
    const w=p.toLowerCase();
    if(usadas.has(w)&&w.length>4) return false;
    usadas.add(w); return true;
  }).join(" ");
}

function introducao(tema){
  return evitarRepeticao(
    escolher([
      `Na sociedade atual, ${tema.toLowerCase()} é um assunto relevante.`,
      `Atualmente, discute-se cada vez mais sobre ${tema.toLowerCase()}.`,
      `Nos últimos anos, ${tema.toLowerCase()} ganhou destaque social.`
    ]) +
    " " +
    escolher([
      `Esse tema merece reflexão.`,
      `Esse assunto afeta a sociedade.`,
      `Dessa forma, torna-se importante analisá-lo.`
    ])
  );
}

function desenvolvimento(tema){
  return evitarRepeticao(
    escolher([
      `Primeiramente, ${tema.toLowerCase()} influencia o cotidiano.`,
      `Além disso, ${tema.toLowerCase()} gera impactos sociais.`,
      `Outro ponto relevante é que ${tema.toLowerCase()} afeta a coletividade.`
    ]) +
    " " +
    escolher([
      `Isso ocorre por fatores sociais.`,
      `Tal situação é agravada pela falta de conscientização.`,
      `Esses fatores contribuem para o problema.`
    ]) +
    " " +
    escolher([
      `Assim, compreender essa questão é essencial.`,
      `Portanto, o debate se torna necessário.`,
      `Dessa maneira, a reflexão é indispensável.`
    ])
  );
}

function conclusao(tema){
  return evitarRepeticao(
    escolher([
      `Portanto, ${tema.toLowerCase()} exige atenção da sociedade.`,
      `Diante disso, percebe-se a importância de discutir ${tema.toLowerCase()}.`,
      `Assim, torna-se evidente a relevância desse tema.`
    ]) +
    " " +
    escolher([
      `O debate consciente contribui para avanços sociais.`,
      `Refletir sobre esse assunto é fundamental.`,
      `A análise crítica favorece melhorias coletivas.`
    ])
  );
}

function notaSimulada(){ return Math.floor(700+Math.random()*300); }

function avaliacaoProfessor(){
  return `
AVALIAÇÃO DO PROFESSOR

Clareza: ${Math.floor(7+Math.random()*3)}/10
Coesão: ${Math.floor(7+Math.random()*3)}/10
Argumentação: ${Math.floor(6+Math.random()*4)}/10
Linguagem: ${Math.floor(7+Math.random()*3)}/10
Estrutura: ${Math.floor(7+Math.random()*3)}/10

Comentário:
O texto apresenta boa organização, ideias claras e desenvolvimento adequado ao tema. 
Pode melhorar com exemplos mais específicos e aprofundamento argumentativo.
`;
}

function gerarRedacao(){
  const tema=document.getElementById("tema").value.trim();
  const modo=document.getElementById("modo").value;
  const nivel=document.getElementById("nivel").value;
  if(!tema){resultado.innerText="Digite um tema.";return;}

  let intro=introducao(tema);
  let dev1=desenvolvimento(tema);
  let dev2=desenvolvimento(tema);
  let concl=conclusao(tema);

  textoFinal =
`REDAÇÃO – ${nivel.toUpperCase()}

Tema: ${tema}

Introdução:
${intro}

Desenvolvimento:
${dev1}

${dev2}

Conclusão:
${concl}

Nota simulada: ${notaSimulada()}
`;

  if(modo==="professor"){
    textoFinal += "\n" + avaliacaoProfessor();
  }

  resultado.innerText=textoFinal;
}

function imprimir(){
  if(!textoFinal)return alert("Gere primeiro.");
  let w=window.open("");
  w.document.write("<pre>"+textoFinal+"</pre>");
  w.print();
}

function gerarPDF(){
  if(!textoFinal)return alert("Gere primeiro.");
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  const linhas=doc.splitTextToSize(textoFinal,180);
  doc.text(linhas,10,20);
  doc.save("Redacao.pdf");
}
</script>
</body>
</html>
