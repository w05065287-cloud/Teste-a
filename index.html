<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Plataforma Educacional de Reda√ß√µes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{--cor:#4f46e5}
body{
  margin:0;font-family:Inter,sans-serif;
  background:linear-gradient(135deg,#1e1b4b,#6d28d9);
  padding:20px
}
.hidden{display:none}
.card{
  max-width:1200px;margin:auto;background:#fff;
  border-radius:20px;box-shadow:0 30px 60px rgba(0,0,0,.25)
}
.header{padding:25px;background:var(--cor);color:#fff}
.main{display:grid;grid-template-columns:300px 1fr}
@media(max-width:900px){.main{grid-template-columns:1fr}}
.sidebar{background:#f9fafb;padding:20px;border-right:1px solid #e5e7eb}
.section{
  background:#fff;padding:15px;border-radius:14px;
  margin-bottom:20px;box-shadow:0 8px 18px rgba(0,0,0,.08)
}
.item{padding:10px;border-radius:10px;cursor:pointer}
.item:hover{background:#eef2ff}
.content{padding:30px}
label{font-weight:600;display:block;margin-top:15px}
textarea,input,select{
  width:100%;padding:14px;border-radius:12px;
  border:1px solid #ddd;margin-top:6px
}
textarea{min-height:120px}
.buttons{display:flex;gap:10px;flex-wrap:wrap;margin-top:20px}
button{
  border:none;border-radius:14px;padding:14px 20px;
  font-weight:600;cursor:pointer
}
.primary{background:var(--cor);color:#fff}
.sec{background:#e5e7eb}
.result{
  margin-top:25px;background:#f8fafc;padding:25px;
  border-radius:16px;white-space:pre-wrap;line-height:1.7
}
.box{
  margin-top:20px;padding:20px;border-radius:16px;
  background:#eef2ff;border-left:6px solid var(--cor)
}
.alert{
  margin-top:15px;padding:15px;border-radius:12px;
  background:#fee2e2;color:#991b1b
}
.login{
  max-width:420px;margin:60px auto;background:#fff;
  border-radius:20px;box-shadow:0 30px 60px rgba(0,0,0,.3)
}
.login .header{text-align:center}
.timer{font-weight:700;font-size:18px}
.footer{text-align:center;font-size:13px;padding:15px;color:#666}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="login" id="login">
  <div class="header">
    <h1>IA Educacional</h1>
    <p>Login personalizado</p>
  </div>
  <div class="content">
    <label>Nome</label>
    <input id="nome">

    <label>Usu√°rio</label>
    <input id="user">

    <label>Senha</label>
    <input id="pass" type="password">

    <label>Tipo</label>
    <select id="tipo">
      <option>Aluno</option>
      <option>Professor</option>
    </select>

    <div class="buttons">
      <button class="primary" onclick="registrar()">Criar conta</button>
      <button class="sec" onclick="entrar()">Entrar</button>
    </div>
  </div>
</div>

<!-- APP -->
<div class="card hidden" id="app">
  <div class="header">
    <h1>Plataforma de Reda√ß√µes</h1>
    <p id="modoTxt"></p>
  </div>

  <div class="main">
    <div class="sidebar">
      <div class="section">
        <h3>üìå Modos</h3>
        <div class="item" onclick="modoNormal()">‚úçÔ∏è Produ√ß√£o</div>
        <div class="item" onclick="modoProva()">üìù Prova</div>
        <div class="item" onclick="mostrarRanking()">üèÜ Ranking</div>
      </div>
    </div>

    <div class="content">
      <div id="cronometro" class="timer hidden"></div>

      <label>Tema</label>
      <textarea id="tema"></textarea>

      <label>Texto do aluno</label>
      <textarea id="textoAluno"></textarea>

      <div class="buttons">
        <button class="primary" onclick="gerar()">Gerar</button>
        <button class="primary hidden" id="finalizar" onclick="finalizarProva()">Finalizar Prova</button>
        <button class="sec" onclick="corrigir()">Corrigir</button>
        <button class="sec" onclick="pdf()">PDF</button>
      </div>

      <div id="resultado" class="result"></div>
      <div id="repeticao" class="alert hidden"></div>
      <div id="avaliacao" class="box hidden"></div>
    </div>
  </div>

  <div class="footer">Plataforma Educacional ‚Ä¢ Offline</div>
</div>

<script>
let usuarioAtual=null,modo="",tempo,seg=0,notaAtual=0;

/* LOGIN */
function getUsuarios(){
  return JSON.parse(localStorage.getItem("usuarios")||"[]");
}
function salvarUsuarios(u){
  localStorage.setItem("usuarios",JSON.stringify(u));
}
function registrar(){
  if(!nome.value||!user.value||!pass.value) return alert("Preencha tudo");
  const u=getUsuarios();
  if(u.find(x=>x.usuario===user.value)) return alert("Usu√°rio existe");
  u.push({nome:nome.value,usuario:user.value,senha:pass.value,tipo:tipo.value});
  salvarUsuarios(u);
  alert("Conta criada!");
}
function entrar(){
  const u=getUsuarios().find(x=>x.usuario===user.value&&x.senha===pass.value);
  if(!u) return alert("Login inv√°lido");
  usuarioAtual=u;
  modo=u.tipo;
  login.classList.add("hidden");
  app.classList.remove("hidden");
  modoTxt.innerText=`${modo} ‚Äî ${u.nome}`;
}

/* MODOS */
function modoNormal(){
  clearInterval(tempo);
  cronometro.classList.add("hidden");
  finalizar.classList.add("hidden");
  tema.disabled=false;
}
function modoProva(){
  tema.value="A import√¢ncia da educa√ß√£o na sociedade";
  tema.disabled=true;
  textoAluno.value="";
  seg=0;
  cronometro.classList.remove("hidden");
  finalizar.classList.remove("hidden");
  tempo=setInterval(()=>{
    seg++;
    cronometro.innerText=`Tempo: ${Math.floor(seg/60)}m ${seg%60}s`;
  },1000);
}
function finalizarProva(){
  clearInterval(tempo);
  resultado.innerText="Prova finalizada.\n\n"+textoAluno.value;
}

/* GERA√á√ÉO */
function gerar(){
resultado.innerText=
`Introdu√ß√£o:
Atualmente, ${tema.value.toLowerCase()} √© um tema relevante.

Desenvolvimento:
Esse assunto gera impactos importantes na sociedade.

Conclus√£o:
Portanto, refletir sobre o tema √© essencial.`;
}

/* CORRE√á√ÉO */
function corrigir(){
  if(modo!=="Professor") return alert("Apenas professor");
  const txt=textoAluno.value;
  if(!txt) return;
  const palavras=txt.split(/\s+/).length;
  notaAtual=Math.min(1000,600+Math.floor(palavras/4));
  detectarRepeticao(txt);
  avaliacao.classList.remove("hidden");
  avaliacao.innerText=
`CORRE√á√ÉO

Palavras: ${palavras}
Ortografia: ${palavras>120?8:6}/10
Coes√£o: ${palavras>150?8:6}/10
Argumenta√ß√£o: ${palavras>180?8:7}/10

NOTA: ${notaAtual}

Coment√°rio:
Texto adequado, pode aprofundar argumentos.`;
  salvarRanking();
}

/* REPETI√á√ÉO */
function detectarRepeticao(txt){
  const frases=txt.split(".");
  const set=new Set(); let r=0;
  frases.forEach(f=>{
    let s=f.trim().toLowerCase();
    if(set.has(s)&&s.length>10) r++;
    set.add(s);
  });
  if(r>0){
    repeticao.classList.remove("hidden");
    repeticao.innerText="‚ö† Repeti√ß√£o detectada";
  }else repeticao.classList.add("hidden");
}

/* RANKING */
function salvarRanking(){
  const r=JSON.parse(localStorage.getItem("ranking")||"[]");
  r.push({nome:usuarioAtual.nome,nota:notaAtual});
  localStorage.setItem("ranking",JSON.stringify(r));
}
function mostrarRanking(){
  const r=JSON.parse(localStorage.getItem("ranking")||"[]")
    .sort((a,b)=>b.nota-a.nota);
  resultado.innerText="üèÜ RANKING\n\n"+
    r.map((x,i)=>`${i+1}. ${x.nome} ‚Äì ${x.nota}`).join("\n");
}

/* PDF */
function pdf(){
  const{jsPDF}=window.jspdf;
  const d=new jsPDF();
  d.text(d.splitTextToSize(resultado.innerText+"\n\n"+avaliacao.innerText,180),10,20);
  d.save("Redacao.pdf");
}
</script>

</body>
  </html>
